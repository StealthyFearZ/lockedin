{% extends 'base.html' %}
{% block content %}
{% load static %}

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
     <!-- Make sure you put this AFTER Leaflet's CSS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>

<style>
    #map {
        height: 500px;
        width: 100%;
    }
</style>

<div id="map"></div>

<script>
    var map = L.map('map').setView([33.776174, -84.398815], 14); // Location of Georgia Tech campus

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    /*
    // Test marker
    var marker = L.marker([33.774841, -84.396407]).addTo(map); // Location of CS2340 classroom
    marker.bindPopup("<b>CS2340 Developer</b><br>260 4th Street NW<br>Atlanta, GA 30332")
    */

    // Generate javascript object using JSON job list
    const jobs = JSON.parse('{{ jobs_json|escapejs }}');

    // Iterate over javascript job list and add a marker for each coordinate pair
    jobs.forEach(j => {
        marker = L.marker([j.fields.location_x, j.fields.location_y]).addTo(map)
        marker.bindPopup(`<b>${j.fields.title}</b><br>${j.fields.location}`)
    });


</script>

{% endblock content %}